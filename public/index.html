<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Casual Browser Games - Play Free Online Games</title>
    <meta name="description" content="Play the best casual browser games for free! Enjoy a variety of categories, including puzzle, racing, shooting, and more. No downloads required!">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Sidebar with Categories -->
    <div class="sidebar">
        <h2>Categories</h2>
        <div id="category-grid" class="category-grid"></div>
    </div>

    <!-- Main Content -->
    <div class="content">
        <h1>Casual Browser Games</h1> <!-- âœ… SEO-friendly H1 -->
        <h2 id="category-title">ðŸ”¥ Popular Games ðŸ”¥</h2>
        <div class="games-container" id="games-container"></div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", async function () {
            await loadGameData();
        });

        async function loadGameData() {
            try {
                const response = await fetch('/api/fetchGames');
                if (!response.ok) throw new Error('Failed to fetch games');
                
                const games = await response.json();
                if (!games || games.length === 0) {
                    console.error('No games found.');
                    return;
                }

                initializeCategories(games);
                displayGames(games);
            } catch (error) {
                console.error('Error loading game data:', error);
            }
        }

        function initializeCategories(games) {
            const categoryGrid = document.getElementById("category-grid");
            if (!categoryGrid) {
                console.error("categoryGrid element not found.");
                return;
            }

            categoryGrid.innerHTML = ""; // Clear previous content
            const categories = [...new Set(games.map(game => game.category))];

            categories.forEach(category => {
                let div = document.createElement("div");
                div.classList.add("category-button");
                div.textContent = category;
                div.style.color = getRandomBrightColor(); // Apply random bright colors
                div.addEventListener("click", () => displayGames(games, category));
                categoryGrid.appendChild(div);
            });
        }

        function displayGames(games, category = '') {
            const gamesContainer = document.getElementById("games-container");
            gamesContainer.innerHTML = '';
            const filteredGames = category ? games.filter(game => game.category === category) : games;

            filteredGames.forEach(game => {
                const gameCard = document.createElement("div");
                gameCard.classList.add("game-card");
                gameCard.innerHTML = `<img src="${game.thumbnail}" alt="${game.title}"><p>${game.title}</p>`;
                gameCard.addEventListener("click", () => window.open(game.url, "_blank"));
                gamesContainer.appendChild(gameCard);
            });

            document.getElementById("category-title").textContent = category ? category : "ðŸ”¥ Popular Games ðŸ”¥";
        }

        function getRandomBrightColor() {
            const colors = ["#FF5733", "#FFBD33", "#33FF57", "#33FFBD", "#3357FF", "#FF33A8", "#A833FF"];
            return colors[Math.floor(Math.random() * colors.length)];
        }
    </script>
</body>
</html>
